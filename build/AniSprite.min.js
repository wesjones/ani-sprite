/*
* AniSprite v.0.1.10
* Wes Jones. MIT 2014
*/
!function(a,b){function c(a,b,c){function e(a,b,c){this.x=a,this.y=b,this.radius=c}function f(){for(var a in b.frames)b.frames[a].name=a}function g(){for(var a in c){var b=c[a];G[b]=!1,H[b.key]=a}}function h(a){G[a]=!0}function i(a){G[a]=!1}function j(a){var b=a.keyCode;console.log(b),H[b]&&h(H[b])}function k(a){var b=a.keyCode;H[b]&&i(H[b])}function l(){for(var a in G)if(G[a])return void c[a].action();p.index>=w.frames.length-1&&p.play("stance")}function m(a,b){var c=0,d=0;return c=b.x-a.x,c*=c,d=b.y-a.y,d*=d,Math.sqrt(c+d)}function n(){var c,d,e,f,g;if(w.dependencies){for(f=0,e=[];f<w.dependencies.length;)g="function"==typeof w.dependencies[f]?w.dependencies[f]():w.dependencies[f],g&&(e=e.concat.apply(e,u[w.dependencies[f]].frames)),f+=1;e=e.concat.apply(e,w.frames)}else c=w,e=c.frames;e[x]||(x=0,y=0,c=w,e=c.frames),d=e[x],0===x&&c.start&&c.start(c),d.before&&d.before(c),r+=z,s>q?A+=D*E:(A=0,q=s),q+=A,C&&(z*=C,C>z&&(z=0,C=0)),o||(o=document.getElementsByClassName(a)[0],o.classList.add(b.name),o.style.position="absolute"),o&&(o.style.webkitTransform=t?"scaleX(-1)":"",o.style.backgroundPosition=d.x+"px "+d.y+"px",o.style.width=d.width+"px",o.style.height=d.height+2+"px",o.style.top=q+(d.oy||0)-d.height+"px",o.style.left=r+(p.reverse?-d.width:0)+(d.ox?p.reverse?-1*d.ox:d.ox:0)+"px"),d.wait&&y<d.wait?y+=1:(x+=1,y=0),d.after&&d.after(c),x===e.length&&c.end&&y>=c.wait&&c.end(c)}var o,p=this,q=100,r=100,s=500,t=!1,u=b.frames,v=u.stance,w=v,x=0,y=0,z=0,A=0,B=0,C=0,D=.8,E=5,F=[];f();var G={},H={};g(),window.addEventListener("keydown",j),window.addEventListener("keyup",k),this.start=h,this.stop=i,this.actions=c,this.__defineGetter__("name",function(){return a}),this.__defineGetter__("frames",function(){return u}),this.__defineSetter__("frames",function(a){u=a}),this.__defineGetter__("index",function(){return x}),this.__defineSetter__("index",function(a){x=a}),this.__defineGetter__("y",function(){return q}),this.__defineSetter__("y",function(a){q=isNaN(a)?0:a}),this.__defineGetter__("ground",function(){return s}),this.__defineSetter__("ground",function(a){s=isNaN(a)?0:a}),this.__defineGetter__("x",function(){return r}),this.__defineSetter__("x",function(a){r=isNaN(a)?0:a}),this.__defineGetter__("reverse",function(){return t}),this.__defineSetter__("reverse",function(a){a=!!a,t!==a&&(z*=-1,r+=w.frames[0].width*(t?-1:1)),t=a}),this.__defineGetter__("speed",function(){return z}),this.__defineSetter__("speed",function(a){z=a}),this.__defineGetter__("speedY",function(){return A}),this.__defineSetter__("speedY",function(a){A=a}),this.__defineGetter__("damage",function(){return B}),this.__defineSetter__("damage",function(a){B=a}),this.__defineGetter__("friction",function(){return C}),this.__defineSetter__("friction",function(a){C=a}),this.__defineGetter__("gravity",function(){return D}),this.__defineSetter__("gravity",function(a){D=a}),this.__defineGetter__("wait",function(){return y}),this.__defineGetter__("defaultAni",function(){return v}),this.__defineSetter__("defaultAni",function(a){v=a}),this.play=function(a){u[a]!==w&&(u[a]&&s>q&&!u[a].inAir||w.frames[x]&&w.frames[x].immune||(w=u[a]||u.stance,x=0,y=0))},this.restoreDefault=function(){v=u.stance},this.createSpot=function(a,b,c){return new e(a,b,c)},this.strike=function(a,b,c,d,e){this.reverse?c-=b.width:c=b.width-c,this.dispatch("strike",a.name,this.createSpot(this.x+c,this.y-b.height+d,e))},this.weakSpots=function(a,b,c){var d,e=0,f=c.length;for(F.length=0;f>e;)d=c[e],d.x=this.reverse?this.x+d.x-b.width:this.x+b.width-d.x,d.y=this.y-b.height+d.y,F[e]=d,e+=1;this.dispatch("weakSpots",a.name,c)},this.checkHit=function(a,b,c){for(var d,e,f=0,g=F.length;g>f;){if(d=F[f],e=m(a,d),e<a.radius+d.radius)return B+=b,z+=t?c:-c,C=.25,!0;f+=1}return!1},belt.async.dispatcher(this),d.on(d.events.UPDATE,l),d.on(d.events.UPDATE,n)}b.ani=a,function(a,b){b.belt=a;var c={};c.dispatcher=function(a,b,c){function d(a,b){var c,d;d=j[a],d&&(b?(c=d.indexOf(b),-1!==c&&d.splice(c,1)):d.length=0)}function e(a,b){return j[a]=j[a]||[],j[a].push(b),function(){d(a,b)}}function f(c,f){function g(){d(c,g),f.apply(b||a,arguments)}return e(c,g)}function g(a){return j[a]}function h(b,c){return b&&b.apply(a,c)}function i(a){if(j[a])for(var b=0,c=j[a],d=c.length;d>b;)h(c[b],arguments),b+=1}var j={};b&&c?(a.on=b[c.on]&&b[c.on].bind(b),a.off=b[c.off]&&b[c.off].bind(b),a.once=b[c.once]&&b[c.once].bind(b),a.dispatch=b[c.dispatch].bind(b)):(a.on=e,a.off=d,a.once=f,a.dispatch=i),a.getListeners=g},a.async=c}({},function(){return this}());var d=function(){function a(){c.dispatch(c.events.UPDATE)}var b,c={};return c.events={UPDATE:"aniSpriteEngine:update"},c.start=function(d){d=d||60,c.stop(),b=setInterval(a,1e3/d)},c.stop=function(){clearInterval(b)},c.step=a,belt.async.dispatcher(c),c}();a.engine=d,a.AniSprite=c}({},function(){return this}());