/*
* AniSprite v.0.1.10
* Wes Jones. MIT 2014
*/
!function(a,b){function c(a,b,c){function e(a,b,c,d){this.x=a,this.y=b,this.radius=c,this.name=d}function f(){for(var a in b.frames)b.frames[a].name=a}function g(){for(var a in c){var b=c[a];J[b]=!1,K[b.key]=a}}function h(a){J[a]=!0}function i(a){J[a]=!1}function j(a){var b=a.keyCode;console.log(b),K[b]&&h(K[b])}function k(a){var b=a.keyCode;K[b]&&i(K[b])}function l(){for(var a in J)if(J[a])return void c[a].action();return p.target&&!p.isTargetInFront()?void p.play("turn"):void(p.index>z.frames.length-1&&p.play("stance"))}function m(a,b){var c=0,d=0;return c=b.x-a.x,c*=c,d=b.y-a.y,d*=d,Math.sqrt(c+d)}function n(){var c,d,e,f,g;if(z.dependencies){for(f=0,e=[];f<z.dependencies.length;)g="function"==typeof z.dependencies[f]?z.dependencies[f]():z.dependencies[f],g&&(e=e.concat.apply(e,x[z.dependencies[f]].frames)),f+=1;e=e.concat.apply(e,z.frames)}else c=z,e=c.frames;e[A]||(A=0,B=0,c=z,e=c.frames),d=e[A],0===A&&c.start&&c.start(c),d.before&&d.before(c),r+=C,s>q?D+=G*H:(D=0,q=s),q+=D,F&&(C*=F,F>C&&(C=0,F=0)),o||(o=document.getElementsByClassName(a)[0],o.classList.add(b.name),o.style.position="absolute"),o&&(o.style.webkitTransform=t?"scaleX(-1)":"",o.style.backgroundPosition=d.x+"px "+d.y+"px",o.style.width=d.width+"px",o.style.height=d.height+2+"px",o.style.top=q+(d.oy||0)-d.height+"px",o.style.left=r+(p.reverse?-d.width:0)+(d.ox?p.reverse?-1*d.ox:d.ox:0)+"px"),d.wait&&B<d.wait?B+=1:(A+=1,B=0),d.after&&d.after(c),A===e.length&&c.end&&B>=c.wait&&c.end(c)}var o,p=this,q=100,r=100,s=500,t=!1,u=!1,v=null,w=400,x=b.frames,y=x.stance,z=y,A=0,B=0,C=0,D=0,E=0,F=0,G=.8,H=5,I=[];f();var J={},K={};g(),window.addEventListener("keydown",j),window.addEventListener("keyup",k),this.start=h,this.stop=i,this.actions=c,this.__defineGetter__("name",function(){return a}),this.__defineGetter__("frames",function(){return x}),this.__defineSetter__("frames",function(a){x=a}),this.__defineGetter__("index",function(){return A}),this.__defineSetter__("index",function(a){A=a}),this.__defineGetter__("x",function(){return r}),this.__defineSetter__("x",function(a){r=isNaN(a)?0:a}),this.__defineGetter__("y",function(){return q}),this.__defineSetter__("y",function(a){q=isNaN(a)?0:a}),this.__defineGetter__("width",function(){return z&&z.frames&&(z.frames[A]&&z.frames[A].width||z.frames[0].width)||0}),this.__defineGetter__("height",function(){return z&&z.frames&&(z.frames[A]&&z.frames[A].height||z.frames[0].height)||0}),this.__defineGetter__("ground",function(){return s}),this.__defineSetter__("ground",function(a){s=isNaN(a)?0:a}),this.__defineGetter__("reverse",function(){return t}),this.__defineSetter__("reverse",function(a){a=!!a,t!==a&&(C*=-1,r+=z.frames[0].width*(t?-1:1)),t=a}),this.__defineGetter__("ducked",function(){return u}),this.__defineSetter__("ducked",function(a){u=!!a}),this.__defineGetter__("speed",function(){return C}),this.__defineSetter__("speed",function(a){C=a}),this.__defineGetter__("speedY",function(){return D}),this.__defineSetter__("speedY",function(a){D=a}),this.__defineGetter__("damage",function(){return E}),this.__defineSetter__("damage",function(a){E=a}),this.__defineGetter__("friction",function(){return F}),this.__defineSetter__("friction",function(a){F=a}),this.__defineGetter__("gravity",function(){return G}),this.__defineSetter__("gravity",function(a){G=a}),this.__defineGetter__("target",function(){return v}),this.__defineSetter__("target",function(a){v=a}),this.__defineGetter__("targetMaxDistance",function(){return w}),this.__defineSetter__("targetMaxDistance",function(a){w=a}),this.__defineGetter__("wait",function(){return B}),this.__defineGetter__("defaultAni",function(){return y}),this.__defineSetter__("defaultAni",function(a){y=a}),this.getDistanceToTarget=function(){var a={x:p.target.x+.5*p.target.width,y:p.target.y+.5*p.target.height},b={x:p.x+.5*p.width,y:p.y+.5*p.height};return m(b,a)},this.isTargetInRange=function(){var a=p.getDistanceToTarget();return w>=a},this.isTargetInFront=function(){if(p.target){if(p.target){if(p.target.x<r+.5*p.width&&!p.reverse)return!1;if(p.target.x>r-.5*p.width&&p.reverse)return!1}return!0}return!1},this.play=function(a){x[a]!==z&&(x[a]&&s>q&&!x[a].inAir||z.frames[A]&&z.frames[A].immune||(z=x[a]||x.stance,A=0,B=0))},this.restoreDefault=function(){y=x.stance},this.createSpot=function(a,b,c,d){return new e(a,b,c,d)},this.strike=function(a,b,c,d,e){this.reverse?c-=b.width:c=b.width-c,this.dispatch("strike",a.name,this.createSpot(this.x+c,this.y-b.height+d,e))},this.weakSpots=function(a,b,c){var d,e=0,f=c.length;for(I.length=0;f>e;)d=c[e],d.x=this.reverse?this.x+d.x-b.width:this.x+b.width-d.x,d.y=this.y-b.height+d.y,I[e]=d,e+=1;this.dispatch("weakSpots",a.name,c)},this.checkHit=function(a,b,c){for(var d,e,f=0,g=I.length,h=0,i=100,j=-1;g>f;)d=I[f],h=m(a,d),h<a.radius+d.radius&&i>h&&(j=f),i=h,f+=1;return-1!==j?(E+=b,C+=t?c:-c,F=.25,e="function"==typeof I[j].name?I[j].name(b,c):I[j].name,void(e&&this.play(e))):void 0},belt.async.dispatcher(this),d.on(d.events.UPDATE,l),d.on(d.events.UPDATE,n)}b.ani=a,function(a,b){b.belt=a;var c={};c.dispatcher=function(a,b,c){function d(a,b){var c,d;d=j[a],d&&(b?(c=d.indexOf(b),-1!==c&&d.splice(c,1)):d.length=0)}function e(a,b){return j[a]=j[a]||[],j[a].push(b),function(){d(a,b)}}function f(c,f){function g(){d(c,g),f.apply(b||a,arguments)}return e(c,g)}function g(a){return j[a]}function h(b,c){return b&&b.apply(a,c)}function i(a){if(j[a])for(var b=0,c=j[a],d=c.length;d>b;)h(c[b],arguments),b+=1}var j={};b&&c?(a.on=b[c.on]&&b[c.on].bind(b),a.off=b[c.off]&&b[c.off].bind(b),a.once=b[c.once]&&b[c.once].bind(b),a.dispatch=b[c.dispatch].bind(b)):(a.on=e,a.off=d,a.once=f,a.dispatch=i),a.getListeners=g},a.async=c}({},function(){return this}());var d=function(){function a(){c.dispatch(c.events.UPDATE)}var b,c={};return c.events={UPDATE:"aniSpriteEngine:update"},c.start=function(d){d=d||60,c.stop(),b=setInterval(a,1e3/d)},c.stop=function(){clearInterval(b)},c.step=a,belt.async.dispatcher(c),c}();a.engine=d,a.AniSprite=c}({},function(){return this}());