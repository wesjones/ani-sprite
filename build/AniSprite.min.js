/*
* AniSprite v.0.1.10
* Wes Jones. MIT 2014
*/
!function(a,b){function c(a,b,c){function e(a){z[a]=!0}function f(a){z[a]=!1}function g(a){var b=a.keyCode;console.log(b),A[b]&&e(A[b])}function h(a){var b=a.keyCode;A[b]&&f(A[b])}function i(){for(var a in z)if(z[a])return void c[a].action();l.index>=s.frames.length-1&&l.play("stance")}function j(){var c,d,e,f,g;if(s.dependencies){for(f=0,e=[];f<s.dependencies.length;)g="function"==typeof s.dependencies[f]?s.dependencies[f]():s.dependencies[f],g&&(e=e.concat.apply(e,q[s.dependencies[f]].frames)),f+=1;e=e.concat.apply(e,s.frames)}else c=s,e=c.frames;e[t]||(t=0,u=0,c=s,e=c.frames),d=e[t],0===t&&c.start&&c.start(),d.before&&d.before(),n+=v,o>m?w+=x*y:(w=0,m=o),m+=w,k||(k=document.getElementsByClassName(a)[0],k.classList.add(b.name),k.style.position="absolute"),k&&(k.style.webkitTransform=p?"scaleX(-1)":"",k.style.backgroundPosition=d.x+"px "+d.y+"px",k.style.width=d.width+"px",k.style.height=d.height+2+"px",k.style.top=m+(d.oy||0)-d.height+"px",k.style.left=n+(d.ox||0)+"px"),d.wait&&u<d.wait?u+=1:(t+=1,u=0),d.after&&d.after(),t===e.length&&c.end&&u>=c.wait&&c.end()}var k,l=this,m=100,n=100,o=500,p=!1,q=b.frames,r=q.stance,s=r,t=0,u=0,v=0,w=0,x=.8,y=5,z={},A={};for(var B in c){var C=c[B];z[C]=!1,A[C.key]=B}window.addEventListener("keydown",g),window.addEventListener("keyup",h),this.start=e,this.stop=f,this.actions=c,this.__defineGetter__("name",function(){return a}),this.__defineGetter__("frames",function(){return q}),this.__defineSetter__("frames",function(a){q=a}),this.__defineGetter__("index",function(){return t}),this.__defineSetter__("index",function(a){t=a}),this.__defineGetter__("y",function(){return m}),this.__defineSetter__("y",function(a){m=isNaN(a)?0:a}),this.__defineGetter__("ground",function(){return o}),this.__defineSetter__("ground",function(a){o=isNaN(a)?0:a}),this.__defineGetter__("x",function(){return n}),this.__defineSetter__("x",function(a){n=isNaN(a)?0:a}),this.__defineGetter__("reverse",function(){return p}),this.__defineSetter__("reverse",function(a){a=!!a,p!==a&&(v*=-1),p=a}),this.__defineGetter__("speed",function(){return v}),this.__defineSetter__("speed",function(a){v=a}),this.__defineGetter__("speedY",function(){return w}),this.__defineSetter__("speedY",function(a){w=a}),this.__defineGetter__("gravity",function(){return x}),this.__defineSetter__("gravity",function(a){x=a}),this.__defineGetter__("wait",function(){return u}),this.__defineGetter__("defaultAni",function(){return r}),this.__defineSetter__("defaultAni",function(a){r=a}),this.play=function(a){q[a]!==s&&(q[a]&&o>m&&!q[a].inAir||s.frames[t]&&s.frames[t].immune||(s=q[a]||q.stance,t=0,u=0))},this.restoreDefault=function(){r=q.stance},belt.async.dispatcher(this),d.on(d.events.UPDATE,i),d.on(d.events.UPDATE,j)}b.ani=a,function(a,b){b.belt=a;var c={};c.dispatcher=function(a,b,c){function d(a,b){var c,d;d=j[a],d&&(b?(c=d.indexOf(b),-1!==c&&d.splice(c,1)):d.length=0)}function e(a,b){return j[a]=j[a]||[],j[a].push(b),function(){d(a,b)}}function f(c,f){function g(){d(c,g),f.apply(b||a,arguments)}return e(c,g)}function g(a){return j[a]}function h(b,c){return b&&b.apply(a,c)}function i(a){if(j[a])for(var b=0,c=j[a],d=c.length;d>b;)h(c[b],arguments),b+=1}var j={};b&&c?(a.on=b[c.on]&&b[c.on].bind(b),a.off=b[c.off]&&b[c.off].bind(b),a.once=b[c.once]&&b[c.once].bind(b),a.dispatch=b[c.dispatch].bind(b)):(a.on=e,a.off=d,a.once=f,a.dispatch=i),a.getListeners=g},a.async=c}({},function(){return this}());var d=function(){function a(){c.dispatch(c.events.UPDATE)}var b,c={};return c.events={UPDATE:"aniSpriteEngine:update"},c.start=function(d){d=d||60,c.stop(),b=setInterval(a,1e3/d)},c.stop=function(){clearInterval(b)},c.step=a,belt.async.dispatcher(c),c}();a.engine=d,a.AniSprite=c}({},function(){return this}());