<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="characters/jailBird/jailBird.css">
    <script src="AniSprite.js"></script>
    <script src="characters/jailBird/jailBird.js"></script>
    <style>
        .block {
            display: inline-block;
            vertical-align: top;
        }
        .strike {
            position: absolute;
            top: -10px;
            left: -10px;
            width: 10px;
            height: 10px;
            background-color: rgba(0, 255, 0, 0.5);
            z-index: 100;
        }
        .weakSpot {
            position: absolute;
            top: -10px;
            left: -10px;
            width: 10px;
            height: 10px;
            background-color: rgba(255, 0, 0, 0.5);
            z-index: 100;
        }
        .stepFrame {
            float: right;
        }
        .jailBird.black {
            background: url(characters/jailBird/jailBird-sprite-black.png) no-repeat;
        }
    </style>
    <script>
        ani.engine.start(30);
        var player1 = ani.jailBird('player1', {
            jump:{
                letter: 'W',
                key: 87,
                action: function () {
                    player1.play('jump');
                }
            },
            walkLeft: {
                letter: 'A',
                key: 65,
                action: function () {
                    player1.reverse = true;
                    player1.play('walk');
                }
            },
            duck: {
                letter: 'S',
                key: 83,
                action: function () {
                    player1.play('duck');
                }
            },
            walkRight: {
                letter: 'D',
                key: 68,
                action: function () {
                    player1.reverse = false;
                    player1.play('walk');
                }
            },
            blockHigh: {
                letter: 'Q',
                key: 81,
                action: function () {
                    player1.play('blockHigh');
                }
            },
            blockLow: {
                letter: 'Z',
                key: 90,
                action: function () {
                    player1.play('blockLow');
                }
            },
//            blockAir: {
//                letter: 'Z',
//                key: 90,
//                action: function () {
//                    player1.play('blockLow');
//                }
//            }
            lightPunch: {
                letter: 'R',
                key: 82,
                action: function () {
                    player1.play('lightPunch');
                }
            },
            "knife-lightPunch": {
                letter: 'T',
                key: 84,
                action: function () {
                    player1.play('knife-lightPunch');
                }
            },
            lowKick: {
                letter: 'C',
                key: 67,
                action: function () {
                    player1.play('lowKick');
                }
            },
            hardPunch: {
                letter: 'G',
                key: 71,
                action: function () {
                    player1.play('hardPunch');
                }
            },
            medPunch: {
                letter: 'Y',
                key: 89,
                action: function () {
                    player1.play('medPunch');
                }
            },
            medKick: {
                letter: 'H',
                key: 72,
                action: function () {
                    player1.play('medKick');
                }
            },
            hadPunch2: {
                letter: 'V',
                key: 86,
                action: function () {
                    player1.play('hardPunch2');
                }
            },
            "knife-hardPunch": {
                letter: 'B',
                key: 66,
                action: function () {
                    player1.play('knife-hardPunch');
                }
            },
            hardKick: {
                letter: 'U',
                key: 85,
                action: function () {
                    player1.play('hardKick');
                }
            },
            spinKick: {
                letter: 'J',
                key: 74,
                action: function () {
                    player1.play('spinKick');
                }
            },
            hitFace: {
                letter: 'I',
                key: 73,
                action: function () {
                    player1.play('hitFace');
                }
            },
            hitGut: {
                letter: 'O',
                key: 79,
                action: function () {
                    player1.play('hitGut');
                }
            },
            duckHitFace: {
                letter: 'P',
                key: 80,
                action: function () {
                    player1.play('duckHitFace');
                }
            },

        });

        player1.on('strike', function (event, name, spot) {
            var damage = 0, momentum = 0, strike = document.getElementsByClassName('strike')[0];
            posSpot(strike, spot);

            //TODO: need to implement damage and momentum for each action here.
            if (name === "lightPunch") {
                damage = 10;
                momentum = 10 + Math.abs(player1.speed);
            }

            if (player2.checkHit(spot, damage, momentum)) {
                player2.play('hitFace');
                player2.damage += damage;
                player2.momentum = momentum;
            }
        });

        var player2 = ani.jailBird('player2', {});
        player2.x = 1000;
        player2.reverse = true;

        player2.on('weakSpots', function (event, name, spots) {
            var i = 0, len = spots.length, spot, el = document.getElementsByClassName('weakSpot');
            while (i < len) {
                spot = spots[i];
                posSpot(el[i], spot);
                i += 1;
            }
        });

        function posSpot(el, spot) {
            el.style.left = spot.x - spot.radius + 'px';
            el.style.top = spot.y - spot.radius + 'px';
            el.style.width = spot.radius * 2 + 'px';
            el.style.height = spot.radius * 2 + 'px';
            el.style.borderRadius = spot.radius + 'px';
        }

        function writeOptions(player, controlsClass, animationClass) {
            var i, item,
                controls = document.getElementsByClassName(controlsClass)[0],
                animations = document.getElementsByClassName(animationClass)[0];

            for (i in player.actions) {
                item = player.actions[i];
                controls.innerHTML += "<li>" + item.letter + " = " + i + "</li>"
            }

            for (i in player.frames) {
                animations.innerHTML += "<li>" + i + "</li>";
            }
        }
    </script>
</head>
<body onload="writeOptions(player1, 'player1Instructions', 'player1Animations')">
<ul class="stepFrame">
    <li><a href="javascript:ani.engine.start(prompt('Enter Frames Per Second:'))">FPS</a></li>
    <li><a href="javascript:ani.engine.stop()">Stop</a></li>
    <li><a href="javascript:ani.engine.step()">Step</a></li>
</ul>
<div class="strike"></div>
<div class="weakSpot high"></div>
<div class="weakSpot mid"></div>
<div class="weakSpot low"></div>
<div class="block">
    <div>Instructions</div>
    <ol class="player1Instructions">
    </ol>
</div>
<div class="block">
    <div>Animations</div>
    <ol class="player1Animations">
        <li><a href="javascript:player1.reverse = !player1.reverse">reverse</a></li>
        <li><a href="javascript:player1.restoreDefault()">Restore Default</a></li>
    </ol>
    <div class="player2 black"></div>
    <div class="player1"></div>
</div>
</body>
</html>